<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="referrer" content="origin">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FINGADELIC | The Official Site of Fingazz</title>
    
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/favicon.png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://player.vimeo.com/api/player.js"></script>

    <style>
        :root {
            --bg-dark: #050505; --bg-card: #0a0a0a; --primary: #00f3ff;
            --secondary: #ff0055; --neon-purple: #bd00ff; --text-main: #ffffff;
            --text-muted: #b0b0b0; --font-head: 'Montserrat', sans-serif;
            --font-body: 'Roboto', sans-serif;
            --box-glow: 0 0 20px rgba(189, 0, 255, 0.3), 0 0 40px rgba(0, 243, 255, 0.2);
            --text-glow: 0 0 10px rgba(189, 0, 255, 0.8), 0 0 20px rgba(0, 243, 255, 0.6);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: var(--bg-dark); color: var(--text-main); font-family: var(--font-body); line-height: 1.6; background-image: radial-gradient(circle at center top, #1a0024 0%, #000000 60%); overflow-x: hidden; }
        h1, h2, h3, h4, h5 { font-family: var(--font-head); text-transform: uppercase; letter-spacing: 1px; font-weight: 900; text-shadow: var(--text-glow); }
        a { text-decoration: none; color: inherit; transition: 0.3s; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .section-padding { padding: 100px 0; }
        .text-center { text-align: center; }
        .highlight { color: var(--primary); text-shadow: var(--text-glow); }
        .highlight-pink { color: var(--secondary); text-shadow: 0 0 10px var(--secondary); }
        .hidden { display: none !important; }
        
        /* Buttons */
        .btn { display: inline-block; padding: 12px 30px; border-radius: 4px; font-weight: 700; text-transform: uppercase; cursor: pointer; border: none; font-size: 0.9rem; letter-spacing: 1px; transition: all 0.3s ease; position: relative; overflow: hidden; text-align: center; }
        .btn-primary { background: transparent; color: var(--primary); border: 2px solid var(--primary); box-shadow: 0 0 15px var(--primary), inset 0 0 15px rgba(0, 243, 255, 0.2); text-shadow: 0 0 5px var(--primary); }
        .btn-primary:hover { background: var(--primary); color: #000; box-shadow: 0 0 30px var(--primary), 0 0 50px var(--neon-purple); text-shadow: none; }
        .btn-secondary { background: transparent; border: 2px solid var(--secondary); color: var(--secondary); box-shadow: 0 0 15px var(--secondary); }
        .btn-secondary:hover { background: var(--secondary); color: white; box-shadow: 0 0 30px var(--secondary); }
        .btn-outline-purple { background: transparent; border: 2px solid var(--neon-purple); color: var(--neon-purple); box-shadow: 0 0 15px rgba(189, 0, 255, 0.3); text-align: center; }
        .btn-outline-purple:hover { background: var(--neon-purple); color: white; box-shadow: 0 0 30px var(--neon-purple); }
        
        /* Forms */
        .form-group { margin-bottom: 25px; text-align: left; }
        .form-label { display: block; margin-bottom: 10px; color: var(--text-muted); font-size: 0.9rem; font-weight: 700; text-transform: uppercase; }
        .form-input, .form-textarea, .form-select { width: 100%; padding: 15px; background: #080808; border: 1px solid #333; border-radius: 4px; color: white; font-family: var(--font-body); font-size: 1rem; transition: 0.3s; }
        .form-input:focus, .form-textarea:focus, .form-select:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 15px rgba(0, 243, 255, 0.3); background: #111; }
        .form-textarea { resize: vertical; min-height: 150px; }
        
        /* Password Visibility Styles */
        .password-container { position: relative; }
        .password-toggle-icon { position: absolute; top: 50%; right: 15px; transform: translateY(-50%); cursor: pointer; color: #666; }
        .password-toggle-icon:hover { color: var(--primary); }

        /* Header */
        header { padding: 20px 0; position: fixed; width: 100%; top: 0; z-index: 1000; background: rgba(5, 5, 5, 0.9); border-bottom: 2px solid; border-image: linear-gradient(to right, var(--neon-purple), var(--primary), var(--secondary)) 1; backdrop-filter: blur(15px); }
        nav { display: flex; justify-content: space-between; align-items: center; }
        .header-logo-text { font-family: var(--font-head); font-weight: 900; font-size: 1.5rem; color: var(--text-main); text-transform: uppercase; letter-spacing: 1px; text-shadow: var(--text-glow); }
        .nav-links { display: flex; gap: 40px; }
        .nav-links a { font-size: 1rem; font-weight: 700; text-transform: uppercase; color: #fff; letter-spacing: 2px; }
        .nav-links a:hover { color: var(--primary); text-shadow: 0 0 15px var(--primary); }
        .mobile-only { display: none; }
        .mobile-menu-btn { display: none; font-size: 1.5rem; cursor: pointer; color: white; margin-left: 20px; }
        
        /* Hero */
        .hero { min-height: 100vh; height: auto; display: flex; align-items: center; position: relative; background-color: #000; background-image: url('https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/fingadelic-bg.webp'); background-size: cover; background-position: center; padding-top: 120px; padding-bottom: 50px; }
        .hero-content { position: relative; z-index: 2; max-width: 800px; width: 100%; }
        .hero-logo { max-width: 500px; width: 100%; height: auto; margin-bottom: 30px; filter: drop-shadow(0 0 20px rgba(189, 0, 255, 0.4)); }
        .hero-text-box { background: rgba(0, 0, 0, 0.6); padding: 40px; border-radius: 12px; backdrop-filter: blur(5px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .hero h1 { font-size: 4.5rem; line-height: 0.9; margin-bottom: 20px; text-shadow: 0 0 20px rgba(189, 0, 255, 0.8), 0 0 40px rgba(0, 243, 255, 0.6); }
        .hero p { font-size: 1.2rem; color: #ddd; margin-bottom: 40px; border-left: 3px solid var(--secondary); padding-left: 20px; position: relative; z-index: 2; }
        
        /* Discography */
        .album-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; margin-top: 50px; }
        .album-card { background: var(--bg-card); border-radius: 8px; border: 1px solid #222; overflow: hidden; transition: 0.4s; position: relative; }
        .album-card:hover { border-color: var(--primary); box-shadow: 0 0 30px rgba(0, 243, 255, 0.2); transform: translateY(-5px); }
        .album-art { width: 100%; aspect-ratio: 1/1; background: #111; overflow: hidden; position: relative; }
        .album-art img { width: 100%; height: 100%; object-fit: cover; transition: 0.4s; filter: grayscale(50%); }
        .album-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 15px; opacity: 0; transition: 0.3s; backdrop-filter: blur(3px); }
        .album-card:hover .album-overlay { opacity: 1; }
        .album-card:hover .album-art img { filter: grayscale(0%); transform: scale(1.05); }
        .album-info { padding: 20px; background: #0f0f0f; }
        .album-title { font-weight: 700; color: #fff; margin-bottom: 5px; }
        .album-year { color: var(--text-muted); font-size: 0.9rem; }
        
        /* Academy Section */
        .academy-section { background: #080808; border-top: 2px solid var(--neon-purple); border-bottom: 2px solid var(--secondary); box-shadow: var(--box-glow); }
        .course-layout { display: grid; grid-template-columns: 1fr 1.5fr; gap: 60px; align-items: center; }
        .featured-course-card { background: linear-gradient(145deg, #111, #0a0a0a); border: 2px solid; border-image: linear-gradient(to bottom right, var(--primary), var(--neon-purple)) 1; padding: 40px; position: relative; box-shadow: var(--box-glow); }
        .course-price { font-size: 3rem; font-weight: 900; color: white; margin: 20px 0; text-shadow: 0 0 15px var(--primary); }
        .course-features li { margin-bottom: 12px; color: #ccc; font-size: 1rem; }
        
        /* Bio & Contact */
        .bio-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 70px; align-items: center; }
        .bio-image-container { position: relative; z-index: 1; }
        .bio-border-top { position: absolute; top: -30px; left: -30px; width: 150px; height: 150px; z-index: -1; border-top: 5px solid var(--primary); border-left: 5px solid var(--neon-purple); }
        .bio-border-bottom { position: absolute; bottom: -30px; right: -30px; width: 150px; height: 150px; z-index: -1; border-bottom: 5px solid var(--secondary); border-right: 5px solid var(--primary); }
        .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; }
        .contact-info-box { padding: 30px; background: #0a0a0a; border: 1px solid #222; margin-bottom: 20px; display: flex; align-items: center; gap: 20px; transition: 0.3s; }
        .contact-info-box:hover { border-color: var(--secondary); transform: translateX(10px); }
        .contact-icon { font-size: 1.5rem; color: var(--secondary); }
        
        /* LMS & Video */
        .lms-container { display: grid; grid-template-columns: 350px 1fr; height: 100vh; padding-top: 85px; }
        .lms-sidebar { background: #080808; border-right: 1px solid #333; display: flex; flex-direction: column; overflow: hidden; height: 100%; }
        .lms-progress-card { padding: 20px; background: #111; border-bottom: 1px solid #333; flex-shrink: 0; }
        .progress-bar { width: 100%; height: 6px; background: #333; border-radius: 3px; margin-top: 10px; overflow: hidden;}
        .progress-fill { width: 15%; height: 100%; background: var(--primary); box-shadow: 0 0 10px var(--primary); }
        .module-list { flex-grow: 1; overflow-y: auto; }
        .lesson-item { padding: 15px 20px; cursor: pointer; border-left: 3px solid transparent; transition: 0.2s; display: flex; align-items: center; color: #ccc; border-bottom: 1px solid #222; }
        .lesson-item:hover { background: #151515; color: white; }
        .lesson-item.active { background: rgba(0, 243, 255, 0.05); border-left: 3px solid var(--primary); color: var(--primary); }
        .lms-content { padding: 40px; background: #050505; overflow-y: auto; }
        .video-container { width: 100%; background: #000; border: 1px solid #333; margin-bottom: 30px; position: relative; aspect-ratio: 16/9; }
        .resources-box { background: #111; border: 1px solid #333; padding: 20px; border-radius: 8px; margin-top: 30px; }
        .resource-item { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; color: #ccc; }
        .lms-help-footer { padding: 20px; border-top: 1px solid #222; background: #080808; flex-shrink: 0; }

        /* Modals */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); backdrop-filter: blur(8px); z-index: 2000; display: none; align-items: center; justify-content: center; }
        .checkout-modal { background: #0a0a0a; border: 2px solid var(--primary); width: 100%; max-width: 500px; padding: 40px; border-radius: 10px; box-shadow: 0 0 50px rgba(0, 243, 255, 0.2); text-align: center; position: relative; }
        .login-modal-box { background: #0a0a0a; border: 2px solid var(--secondary); width: 100%; max-width: 400px; padding: 40px; border-radius: 10px; box-shadow: 0 0 50px rgba(255, 0, 85, 0.2); text-align: center; position: relative; }
        .trailer-modal-box { background: #0a0a0a; border: 2px solid var(--neon-purple); width: 95%; max-width: 800px; padding: 20px; border-radius: 10px; box-shadow: 0 0 50px rgba(189, 0, 255, 0.2); text-align: center; position: relative; }
        
        .close-modal { position: absolute; top: 15px; right: 20px; font-size: 1.5rem; cursor: pointer; color: #666; transition:0.3s;}
        .close-modal:hover { color: white; }

        /* Trailer Overlay Styles */
        #trailer-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8) url('https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/course-preview-1.jpg') center/cover;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; z-index: 10; transition: 0.3s;
        }
        #trailer-overlay:hover { filter: brightness(1.2); }
        .play-btn-circle {
            width: 80px; height: 80px; border-radius: 50%;
            background: var(--neon-purple); color: white;
            display: flex; align-items: center; justify-content: center;
            font-size: 30px; box-shadow: 0 0 30px var(--neon-purple);
        }

        @media (max-width: 900px) {
            .mobile-only { display: block; }
            .header-logo-text { font-size: 1.2rem; }
            .nav-links { position: fixed; top: 0; right: -100%; height: 100vh; width: 70%; background: #000; border-left: 2px solid var(--primary); flex-direction: column; justify-content: center; align-items: center; transition: 0.3s; z-index: 1000; }
            .nav-links.active { right: 0; display: flex; }
            .mobile-menu-btn { display: block; }
            .hero h1 { font-size: 2.8rem; }
            .course-layout, .album-grid, .contact-grid { grid-template-columns: 1fr; }
            .section-padding { padding: 50px 0; }
            .contact-grid { gap: 30px; }
            .lms-container { display: flex; flex-direction: column; height: auto; padding-top: 60px; }
            .lms-content { order: 1; padding: 20px; height: auto; overflow: visible; }
            .lms-sidebar { display: block !important; order: 2; border-right: none; border-top: 1px solid #333; height: auto; max-height: 500px; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="header-logo-text">FINGADELIC.COM</div>
                <ul class="nav-links" id="navLinks">
                    <li><a href="#" onclick="showSection('landing'); toggleMenu()">Music</a></li>
                    <li><a href="#courses" onclick="showSection('landing'); toggleMenu()">Courses</a></li>
                    <li><a href="#about" onclick="showSection('landing'); toggleMenu()">About</a></li>
                    <li><a href="#contact" onclick="showSection('landing'); toggleMenu()">Contact</a></li>
                    <li style="margin-top:20px; font-size: 2rem; cursor:pointer;" onclick="toggleMenu()" class="mobile-only">×</li>
                </ul>
                <div style="display:flex; gap:15px; align-items:center;">
                    <button id="nav-login-btn" onclick="openLoginModal()" class="btn btn-secondary" style="padding: 10px 20px; font-size: 0.8rem;">Student Login</button>
                    <div class="mobile-menu-btn" onclick="toggleMenu()">
                        <i class="fas fa-bars"></i>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <div id="landing-page">
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/fingadelic-text.png" alt="Fingadelic Logo" class="hero-logo">
                    <div class="hero-text-box">
                        <h4 style="color: var(--primary); margin-bottom: 10px; text-shadow: 0 0 10px var(--primary);">Music Producer / Talkbox Artist</h4>
                        <h1>The Future <br><span style="color: transparent; -webkit-text-stroke: 2px white; text-shadow: none;">Of Funk</span></h1>
                        <p>Fingazz - a dominant authority on the modern Talkbox sound. Bridging the gap between Zapp & Roger and the future of Electronic Funk Music.</p>
                        <div style="display:flex; gap: 25px; flex-wrap: wrap;">
                            <a href="#music" class="btn btn-primary">Listen to Music</a>
                            <a href="#courses" class="btn btn-secondary">Learn Production</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="courses" class="section-padding academy-section">
            <div class="container">
                <div class="course-layout">
                    <div>
                        <h4 style="color: var(--secondary); text-shadow: 0 0 10px var(--secondary);">The Fingadelic Academy</h4>
                        <h2 style="font-size: 3rem; margin-bottom: 20px;">Master The <br><span class="highlight" style="color: var(--neon-purple); text-shadow: 0 0 20px var(--neon-purple);">Sound</span></h2>
                        <p style="color: #ccc; margin-bottom: 30px;">You've heard the music. Now learn how it's made. Fingazz opens up his session files to teach the production secrets behind his "Electro-Dub-Funk" style.</p>
                    </div>
                    <div class="featured-course-card">
                        <h3 style="font-size: 2rem; color: white; margin-bottom: 10px;">Future Funk 4 All</h3>
                        <p style="color: var(--primary); font-weight: 700;">The definitive production master class.</p>
                        <div id="course-price-display" class="course-price">$99 <span style="font-size: 1rem; color: #aaa; font-weight: 400; text-shadow: none;">/ Lifetime Access</span></div>
                        <ul class="course-features">
                            <li><i class="fas fa-video" style="color:var(--secondary); margin-right:10px;"></i> Step by step video tutorials by Fingazz</li>
                            <li><i class="fas fa-fast-forward" style="color:var(--secondary); margin-right:10px;"></i> Detailed techniques to take your Funk into the future</li>
                            <li><i class="fas fa-drum" style="color:var(--secondary); margin-right:10px;"></i> Free presets and drum kits</li>
                            <li><i class="fas fa-upload" style="color:var(--secondary); margin-right:10px;"></i> Real feedback and support</li>
                        </ul>
                        <div id="course-cta-container" style="margin-top: 40px; display:grid; gap:15px;">
                            <button onclick="openTrailer()" class="btn btn-outline-purple" style="width: 100%;">EXPLORE THE COURSE</button>
                            <button onclick="checkLoginAndPay()" class="btn btn-primary" style="width: 100%;">Enroll Now</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="music" class="section-padding">
            <div class="container">
                <h2 class="text-center">Selected <span class="highlight-pink">Discography</span></h2>
                <div class="album-grid">
                    <div class="album-card">
                        <div class="album-art"><img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/winning.webp" alt="Winning"><div class="album-overlay"><a href="https://tr.ee/LggaiH9ung" target="_blank" class="btn btn-primary" style="padding: 10px 25px;">Stream</a></div></div>
                        <div class="album-info"><div class="album-title">Winning (Single)</div><div class="album-year">2014 • Dancer Favorite</div></div>
                    </div>
                    <div class="album-card">
                        <div class="album-art"><img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/i-can-make-ya.webp" alt="I Can Make Ya"><div class="album-overlay"><a href="https://tr.ee/_BGZz88BNl" target="_blank" class="btn btn-primary" style="padding: 10px 25px;">Stream</a></div></div>
                        <div class="album-info"><div class="album-title">I Can Make Ya</div><div class="album-year">2013 • Legendary Tribute</div></div>
                    </div>
                    <div class="album-card">
                        <div class="album-art"><img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/boogie-bruthaz.webp" alt="Boogie Bruthaz"><div class="album-overlay"><a href="https://tr.ee/_BGZz88BNl" target="_blank" class="btn btn-primary" style="padding: 10px 25px;">Stream</a></div></div>
                        <div class="album-info"><div class="album-title">Boogie Bruthaz</div><div class="album-year">2014 • Dancer Favorite</div></div>
                    </div>
                    <div class="album-card">
                        <div class="album-art"><img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/feel.webp" alt="Feel"><div class="album-overlay"><a href="https://tr.ee/dEHLrTTly_" target="_blank" class="btn btn-primary" style="padding: 10px 25px;">Stream</a></div></div>
                        <div class="album-info"><div class="album-title">Feel (Single)</div><div class="album-year">2021 • Feat. SERGIIO</div></div>
                    </div>
                    <div class="album-card">
                        <div class="album-art"><img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/7dayz.webp" alt="7DAYZ"><div class="album-overlay"><a href="https://tr.ee/Io3HnYEgN3" target="_blank" class="btn btn-primary" style="padding: 10px 25px;">Stream</a></div></div>
                        <div class="album-info"><div class="album-title">7DAYZ</div><div class="album-year">2021 • Original Album</div></div>
                    </div>
                    <div class="album-card">
                        <div class="album-art"><img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/vi$ionz.webp" alt="VI$IONZ"><div class="album-overlay"><a href="https://tr.ee/5xWQZn7OeV" target="_blank" class="btn btn-primary" style="padding: 10px 25px;">Stream</a></div></div>
                        <div class="album-info"><div class="album-title">VI$IONZ</div><div class="album-year">2016 • Original Album</div></div>
                    </div>
                    <div class="album-card">
                        <div class="album-art"><img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/classics3.webp" alt="CLASSICS 3"><div class="album-overlay"><a href="https://tr.ee/zizhQob7cd" target="_blank" class="btn btn-primary" style="padding: 10px 25px;">Stream</a></div></div>
                        <div class="album-info"><div class="album-title">CLASSICS 3</div><div class="album-year">2014 • Talkbox Tributes</div></div>
                    </div>
                    <div class="album-card">
                        <div class="album-art"><img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/classics-iv.webp" alt="CLASSICS IV"><div class="album-overlay"><a href="https://tr.ee/UEmaz4Mvvx" target="_blank" class="btn btn-primary" style="padding: 10px 25px;">Stream</a></div></div>
                        <div class="album-info"><div class="album-title">CLASSICS IV</div><div class="album-year">2023 • Talkbox Tributes</div></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="about" class="section-padding">
            <div class="container bio-grid">
                <div class="bio-image-container">
                    <div class="bio-border-top"></div>
                    <img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/fingazz-about.webp" alt="Fingazz" style="width: 100%; border-radius: 5px; filter: grayscale(100%) contrast(120%); position: relative; z-index: 2;">
                    <div class="bio-border-bottom"></div>
                </div>
                <div>
                    <h2 style="margin-bottom: 20px;">The <span class="highlight" style="color: var(--neon-purple);">Architect</span></h2>
                    <p style="color: #ccc; margin-bottom: 20px;">
                        From all corners of Southern California to global stages, Multi-Platinum producer Fingazz has established himself as a notable force in modern music. As the creator of the <strong>TalkStar</strong> talkbox, he didn't just play the instrument—he evolved it.
                    </p>
                    <p style="color: #ccc;">
                        With a career spanning over two decades, he continues to push the boundaries of Funk music, blending classic analog synthesis with modern digital production techniques - leading the way in the new genre "Future Funk" with songs like "Winning" that has amassed 40 Mil streams worldwide.
                    </p>
                    <div class="bio-image-container" style="margin-top: 60px;">
                        <div class="bio-border-top"></div>
                        <img src="https://raw.githubusercontent.com/fingadelic/fingadelic-site/main/images/FINGAZZ_PLAQUE.jpg" alt="Fingazz Plaque" style="width: 100%; border-radius: 5px; filter: grayscale(100%) contrast(120%); position: relative; z-index: 2;">
                        <div class="bio-border-bottom"></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="section-padding" style="background: #080808; border-top: 2px solid #222;">
            <div class="container">
                <h2 class="text-center" style="margin-bottom: 60px;">Book The <span class="highlight-pink">Architect</span></h2>
                <div class="contact-grid">
                    <div>
                        <p style="color: #ccc; margin-bottom: 30px;">For serious inquiries regarding booking, production, remixes, or Talkbox features.</p>
                        
                        <a href="https://instagram.com/fingadelic" target="_blank" class="contact-info-box" style="text-decoration: none; cursor: pointer;">
                            <div class="contact-icon"><i class="fab fa-instagram"></i></div>
                            <div>
                                <h4 style="font-size: 1rem; color: white; margin-bottom: 5px;">Follow on Instagram</h4>
                                <div style="color: #888;">Behind the scenes & updates</div>
                            </div>
                        </a>

                        <a href="https://www.youtube.com/@FingazzHouse" target="_blank" class="contact-info-box" style="text-decoration: none; cursor: pointer;">
                            <div class="contact-icon"><i class="fab fa-youtube"></i></div>
                            <div>
                                <h4 style="font-size: 1rem; color: white; margin-bottom: 5px;">Subscribe on YouTube</h4>
                                <div style="color: #888;">Live streams & beat making</div>
                            </div>
                        </a>
                    </div>
                    <div>
                        <form action="https://formspree.io/f/mkovypdp" method="POST">
    			<div class="form-group">
        			<label class="form-label">Name</label>
        			<input type="text" name="Name" class="form-input" placeholder="Your Name or Agency" required>
    </div>
    <div class="form-group">
        <label class="form-label">Email</label>
        <input type="email" name="Email" class="form-input" placeholder="contact@email.com" required>
    </div>
    <div class="form-group">
        <label class="form-label">Subject</label>
        <select name="Subject" class="form-select">
            <option value="Booking Request">Booking Request</option>
            <option value="Collaboration / Feature">Collaboration / Feature</option>
            <option value="Press / Media">Press / Media</option>
            <option value="General Inquiry">General Inquiry</option>
        </select>
    </div>
    <div class="form-group">
        <label class="form-label">Message</label>
        <textarea name="Message" class="form-textarea" placeholder="Tell us about your project..." required></textarea>
    </div>
    <button type="submit" class="btn btn-primary" style="width: 100%;">Send Message</button>
</form>
                    </div>
                </div>
            </div>
        </section>
        
        <footer style="background:#050505; padding:60px 0; border-top:2px solid; border-image: linear-gradient(to right, var(--secondary), var(--neon-purple), var(--primary)) 1; text-align:center;">
            <div class="container">
                <div style="font-family: var(--font-head); font-weight: 900; font-size: 1.5rem; color: var(--text-muted); opacity:0.5; margin-bottom:20px;">FINGADELIC MUSIC</div>
                <p style="color:#666;">&copy; 2026 Fingadelic Music. All Rights Reserved.</p>
            </div>
        </footer>
    </div>

    <div id="lms-page" class="hidden">
        <div class="lms-container">
            <div class="lms-sidebar">
                <div class="lms-progress-card">
                    <h5 style="color:white; margin-bottom:5px;">Future Funk 4 All</h5>
                    <div style="font-size:0.8rem; color:#888;">Student Access</div>
                    <div class="progress-bar"><div class="progress-fill"></div></div>
                </div>
                <div class="module-list" id="lesson-list-container"></div>
                
                <div class="lms-help-footer">
                    <a href="mailto:thegetdown@fingadelic.com?subject=Help Request - Fingadelic Academy" class="btn btn-secondary" style="width:100%; display:block; text-align:center;">
                        <i class="fas fa-life-ring" style="margin-right:8px;"></i> GET HELP
                    </a>
                </div>
            </div>
            
            <div class="lms-content">
                <div class="video-container">
                    <div id="video-display"></div>
                </div>
                <div class="lesson-header" style="border-bottom: 1px solid #222; padding-bottom:20px;">
                    <h2 id="lesson-title">Welcome</h2>
                    <p id="lesson-desc" style="color: #888;">Select a lesson to begin.</p>
                </div>
                <div class="resources-box">
                    <h4 style="color:white; margin-bottom:15px;">Downloads</h4>
                    <div class="resource-item" style="color:#888;">Resources for this lesson will appear here.</div>
                </div>
            </div>
        </div>
    </div>

    <div id="checkout-modal" class="modal-overlay">
        <div class="checkout-modal">
            <div class="close-modal" onclick="closeCheckout()">×</div>
            <h3>Secure Checkout</h3>
            
            <div id="checkout-price-display" style="font-size: 1.8rem; font-weight:900; color:white; margin:15px 0;">Total: $99.00</div>
            
            <div style="display:flex; gap:10px; justify-content:center; margin-bottom:20px;">
                <input type="text" id="promo-input" placeholder="Promo Code" style="padding:10px; border-radius:4px; border:1px solid #333; background:#111; color:white; text-transform:uppercase;">
                <button onclick="applyCoupon()" class="btn btn-secondary" style="padding:10px 20px; font-size:0.8rem;">APPLY</button>
            </div>
            <div id="coupon-message" style="margin-bottom:20px; font-size:0.9rem; min-height:1.2em;"></div>
            
            <div id="paypal-button-container"></div>
            <button id="free-unlock-btn" onclick="unlockFreeCourse()" class="btn btn-primary hidden" style="width:100%; margin-top:20px;">UNLOCK COURSE FOR FREE</button>
        </div>
    </div>
    
    <div id="login-modal" class="modal-overlay">
        <div class="login-modal-box">
            <div class="close-modal" onclick="closeLoginModal()">×</div>
            <h3 id="auth-title">Student Login</h3>
            
            <input type="text" id="student-name" class="form-input hidden" placeholder="Full Name" style="margin-bottom:15px;">
            
            <input type="email" id="student-email" class="form-input" placeholder="Email" style="margin-bottom:15px;">
            
            <div class="password-container" style="margin-bottom:15px;">
                <input type="password" id="student-pass" class="form-input" placeholder="Password">
                <i class="fas fa-eye password-toggle-icon" onclick="togglePassword('student-pass')"></i>
            </div>

            <div id="confirm-pass-container" class="password-container hidden" style="margin-bottom:15px;">
                <input type="password" id="student-pass-confirm" class="form-input" placeholder="Confirm Password">
                <i class="fas fa-eye password-toggle-icon" onclick="togglePassword('student-pass-confirm')"></i>
            </div>

            <button id="auth-action-btn" onclick="handleAuthAction()" class="btn btn-secondary" style="width:100%">Log In</button>
            
            <div style="margin-top:15px; font-size:0.9rem; color:#888;">
                <span id="auth-toggle-text">Need an account?</span> 
                <a href="#" onclick="toggleAuthMode()" style="color:var(--primary); font-weight:bold;">Click Here</a>
            </div>
            
            <p id="login-error" style="color:red; margin-top:10px;"></p>
        </div>
    </div>
    
    <div id="trailer-modal" class="modal-overlay">
        <div class="trailer-modal-box">
            <div class="close-modal" onclick="closeTrailer()">×</div>
            <h3 style="margin-bottom: 15px; text-transform:uppercase; color:white;">Course Preview</h3>
            
            <div id="trailer-wrapper" style="position:relative; padding:56.25% 0 0 0;">
                <iframe id="trailer-video-frame" src="https://player.vimeo.com/video/1165258315?badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" style="position:absolute;top:0;left:0;width:100%;height:100%;" title="Course Trailer"></iframe>
                
                <div id="trailer-overlay" onclick="playTrailerWithSound()">
                    <div class="play-btn-circle"><i class="fas fa-play"></i></div>
                    <div style="margin-top:10px; font-weight:900;">WATCH TRAILER</div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.paypal.com/sdk/js?client-id=Afwqwk-2ytBnWm2TzVwwh1AuQgR7FPOS4mJ7x2MUngQLEJQTYWTX7Ib3wqeFlna_obWbBfTnfMzU8JeD&currency=USD"></script>
    
    <script>
        const supabaseUrl = 'https://fiqeqrtywxvrdkpyiebz.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZpcWVxcnR5d3h2cmRrcHlpZWJ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA1ODY3NDcsImV4cCI6MjA4NjE2Mjc0N30.FiUKSifWssU-oloDyKa54IJCsjkiaq79vNZ4dKazCM8';
        const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);

        const basePrice = '99.00'; 
        let currentPrice = basePrice;

        // --- AUTH LOGIC (UPDATED) ---
        let isSignupMode = false;

        function toggleAuthMode() {
            isSignupMode = !isSignupMode;
            const title = document.getElementById('auth-title');
            const nameInput = document.getElementById('student-name');
            const confirmContainer = document.getElementById('confirm-pass-container');
            const actionBtn = document.getElementById('auth-action-btn');
            const toggleText = document.getElementById('auth-toggle-text');
            const errorMsg = document.getElementById('login-error');

            // Clear errors
            errorMsg.innerText = "";

            if (isSignupMode) {
                // Show Signup Fields
                title.innerText = "Create Account";
                nameInput.classList.remove('hidden');
                confirmContainer.classList.remove('hidden');
                actionBtn.innerText = "Register";
                actionBtn.classList.remove('btn-secondary');
                actionBtn.classList.add('btn-outline-purple');
                toggleText.innerHTML = "Have an account? ";
            } else {
                // Show Login Fields
                title.innerText = "Student Login";
                nameInput.classList.add('hidden');
                confirmContainer.classList.add('hidden');
                actionBtn.innerText = "Log In";
                actionBtn.classList.remove('btn-outline-purple');
                actionBtn.classList.add('btn-secondary');
                toggleText.innerHTML = "Need an account? ";
            }
        }

        function togglePassword(fieldId) {
            const input = document.getElementById(fieldId);
            if (input.type === "password") {
                input.type = "text";
            } else {
                input.type = "password";
            }
        }

        async function handleAuthAction() {
            if (isSignupMode) {
                await attemptSignUp();
            } else {
                await attemptLogin();
            }
        }

        async function attemptLogin() {
            const email = document.getElementById('student-email').value;
            const password = document.getElementById('student-pass').value;
            const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });
            
            if (!error) {
                closeLoginModal();
                updateCourseUI(data.user);
                updateNavButton({ user: data.user });
                if (window.pendingCheckout) {
                    openCheckout();
                    window.pendingCheckout = false;
                }
            } else {
                document.getElementById('login-error').innerText = error.message;
            }
        }

        async function attemptSignUp() {
            const name = document.getElementById('student-name').value;
            const email = document.getElementById('student-email').value;
            const password = document.getElementById('student-pass').value;
            const confirm = document.getElementById('student-pass-confirm').value;
            
            // Validation
            if (!email || !password || !name) {
                document.getElementById('login-error').innerText = "Please fill in all fields.";
                return;
            }
            if (password !== confirm) {
                document.getElementById('login-error').innerText = "Passwords do not match.";
                return;
            }

            const { data, error } = await supabaseClient.auth.signUp({
                email: email,
                password: password,
                options: {
                    data: {
                        full_name: name // Saves name to user metadata
                    }
                }
            });

            if (error) {
                document.getElementById('login-error').innerText = error.message;
                return;
            }

            // Check if email confirmation is required (Session will be null)
            if (data.user && !data.session) {
                alert("Registration successful! \n\nPlease check your email to confirm your account before logging in.");
                closeLoginModal();
                // Do NOT open checkout yet. They need to verify first.
                return;
            }

            // If we get here, they are logged in (Email confirmation is likely disabled in Supabase)
            alert("Account created! You are now logged in.");
            closeLoginModal();
            updateCourseUI(data.user);
            updateNavButton({ user: data.user });

            if (window.pendingCheckout) {
                openCheckout();
                window.pendingCheckout = false;
            }
        }

        // --- TRAILER LOGIC ---
        let trailerPlayer = null;

        function openTrailer() {
            document.getElementById('trailer-modal').style.display = 'flex';
            document.getElementById('trailer-overlay').style.display = 'flex';
            if (!trailerPlayer) {
                trailerPlayer = new Vimeo.Player(document.querySelector('#trailer-video-frame'));
            }
        }
        
        function playTrailerWithSound() {
            document.getElementById('trailer-overlay').style.display = 'none';
            if(trailerPlayer) {
                trailerPlayer.setVolume(1).then(() => {
                    trailerPlayer.play();
                });
            }
        }

        function closeTrailer() {
            document.getElementById('trailer-modal').style.display = 'none';
            if (trailerPlayer) {
                trailerPlayer.pause();
            }
        }

        // --- CHECKOUT LOGIC ---
        function applyCoupon() {
            const input = document.getElementById('promo-input');
            const message = document.getElementById('coupon-message');
            const priceDisplay = document.getElementById('checkout-price-display');
            const paypalBtn = document.getElementById('paypal-button-container');
            const freeBtn = document.getElementById('free-unlock-btn');
            
            const code = input.value.trim().toUpperCase();

            paypalBtn.style.display = 'block';
            freeBtn.classList.add('hidden');

            if (code === 'INTRO20') {
                const numPrice = parseFloat(basePrice);
                currentPrice = (numPrice * 0.80).toFixed(2);
                message.style.color = '#00f3ff';
                message.innerText = "20% DISCOUNT APPLIED!";
                priceDisplay.innerHTML = `Total: <span style="text-decoration:line-through; color:#666; font-size:1rem;">$${basePrice}</span> $${currentPrice}`;
            
            } else if (code === 'THEHOOKUP') {
                currentPrice = 0;
                message.style.color = '#bd00ff';
                message.innerText = "VIP ACCESS GRANTED!";
                priceDisplay.innerHTML = `Total: <span style="text-decoration:line-through; color:#666; font-size:1rem;">$${basePrice}</span> $0.00`;
                paypalBtn.style.display = 'none';
                freeBtn.classList.remove('hidden');

            } else {
                message.style.color = 'red';
                message.innerText = "INVALID PROMO CODE";
                currentPrice = basePrice;
                priceDisplay.innerText = "Total: $" + basePrice;
            }
        }

        async function unlockFreeCourse() {
            const { data: { user } } = await supabaseClient.auth.getUser();
            if (user) {
                await supabaseClient.from('profiles').update({ has_access: true }).eq('id', user.id);
                alert("Course Unlocked! Welcome to the Academy."); 
                closeCheckout(); 
                updateCourseUI(user);
                showSection('lms');
            } else {
                alert("Error: You must be logged in.");
            }
        }

        function resetCheckout() {
            currentPrice = basePrice;
            document.getElementById('promo-input').value = "";
            document.getElementById('coupon-message').innerText = "";
            document.getElementById('checkout-price-display').innerText = "Total: $" + basePrice;
            document.getElementById('paypal-button-container').style.display = 'block';
            document.getElementById('free-unlock-btn').classList.add('hidden');
        }

        // --- LMS DATA ---
        const lessonData = [
            { 
                id: "1162224336",
                h: "4dfac5359a",
                title: "SECTION 1", 
                desc: "INTRODUCTION",
                details: `
                    1.1 MEET YOUR INSTRUCTOR - 1.2 FUNK HISTORY - 1.3 MODERN FUNK - 1.4 FUTURE FUNK - 1.5 COURSE ESSENTIALS
                    <br><br>
                    <strong>Class Resources:</strong><br>
                    <a href="https://youtube.com/playlist?list=PLWp-SK5QKjYLfbMG1OOKMF1i8QTQ9N5YJ&si=nS02bKyyo41sU9Lx" target="_blank" style="color:var(--primary); text-decoration:underline;">• Essential Funk Classics - Playlist</a><br>
                    <a href="https://youtube.com/playlist?list=PLWp-SK5QKjYIpmY9cYg6aHARFuTUduhKe&si=DxE-YSz1o2zc1Qr1" target="_blank" style="color:var(--primary); text-decoration:underline;">• Essential Modern Funk - Playlist</a><br>
                    <a href="https://youtube.com/playlist?list=PLWp-SK5QKjYKCpHlmhN90q8nPWThBZ3D8&si=lMcy7snagz6ZTXuh" target="_blank" style="color:var(--primary); text-decoration:underline;">• Essential Future Funk - Playlist</a>
                `,
                downloadLink: "https://jmp.sh/3uHCQlwC", 
                downloadName: "FF4A_Essentials.zip"
            },
            { 
                id: "1163472789",
                h: "e41098b913", 
                title: "SECTION 2", 
                desc: "THE FOUNDATION - DRUMS",
                details: `
                    2.1 TEMPO & FEEL - 2.2 THE RIGHT DRUMS - 2.3 CLAP/SNARE LAYERING - 2.4 COUNTER-RHYTHM - 2.5 ACCENT "THE 1"
                 `,
                downloadLink: "#", 
                downloadName: "No Download"
            },
            { 
                id: "1164453794",
                h: "15789f5949", 
                title: "SECTION 3", 
                desc: "THE FEEL",
                details: `
                    3.1 OFFSET QUANTIZE - 3.2 MANUAL NOTE SLIDE - 3.3 LET LOOSE - 3.4 SWING OR NAH? 
                 `,
                downloadLink: "#", 
                downloadName: "No Download"
            },
            { 
                id: "1164501959",
                h: "31af15ebef", 
                title: "SECTION 4", 
                desc: "THE BASS",
                details: `
                    4.1 CLASSIC/FUTURE - 4.2 MULTI-BASS THEORY - 4.3 ACCENT "THE 1" AGAIN! 
                 `,
                downloadLink: "#", 
                downloadName: "No Download"
            },
            { 
                id: "1165033261",
                h: "6efc89f9d2", 
                title: "SECTION 5", 
                desc: "THE CHORDS",
                details: `
                    5.1 SOUND SELECTION - 5.2 CUSTOM SERUM PATCH - 5.3 STABS - 5.4 PADS 
                 `,
                downloadLink: "#", 
                downloadName: "No Download"
            },
            { 
                id: "1165033985",
                h: "36e951aa93", 
                title: "SECTION 6", 
                desc: "ARCHITECTURE",
                details: `
                    6.1 THE ARRANGEMENT - 6.2 THE PRE - 6.3 FILLS & BREAKS - 6.4 THE INTRO - 6.5 DIAL IN SECTIONS - 6.6 BOOKENDS 
                 `,
                downloadLink: "#", 
                downloadName: "No Download"
            },
            { 
                id: "1165035163",
                h: "b9400a3905", 
                title: "SECTION 7", 
                desc: "THE CANDY",
                details: `
                    7.1 THE CANDY - 7.2 DROPS & FILLS - 7.3 CYMBALS & RISERS - 7.4 GUITAR & BASS SPRINKLES
                 `,
                downloadLink: "#", 
                downloadName: "No Download"
            },
            { 
                id: "1165043303",
                h: "6c297193ac", 
                title: "SECTION 8", 
                desc: "FINALE",
                details: `
                    8.1 TOP LINE - TALKBOX - 8.2 TOP LINE - HARMONY ENGINE - 8.3 WRAP UP
<br><br>
                    <strong>Class Resources:</strong><br>
                    <a href="https://www.thetalkstar.com" target="_blank" style="color:var(--primary); text-decoration:underline;">• Get your TalkStar professional talkbox NOW 20% off with coupon code "FF4A20"</a><br>
                 `,
                downloadLink: "#", 
                downloadName: "No Download"
            }
        ];

        // --- LMS PLAYER ---
        const lessonList = document.getElementById('lesson-list-container');
        if (lessonList) {
            lessonData.forEach((lesson, index) => {
                const div = document.createElement('div');
                div.className = 'lesson-item';
                div.innerHTML = `<div><i class="fas fa-play-circle" style="margin-right:10px;"></i> ${lesson.title}</div>`;
                div.onclick = () => { loadLesson(index); };
                lessonList.appendChild(div);
            });
        }

        let vimeoPlayer = null;

        function loadLesson(index) {
            const lesson = lessonData[index];
            updateLessonText(index);

            if (vimeoPlayer) {
                vimeoPlayer.destroy().then(() => {
                    createPlayer(lesson);
                });
            } else {
                createPlayer(lesson);
            }
        }

        function createPlayer(lesson) {
            const container = document.getElementById('video-display');
            if(container) {
                container.innerHTML = ""; 
                const videoUrl = `https://vimeo.com/${lesson.id}/${lesson.h || ''}`;
                
                vimeoPlayer = new Vimeo.Player('video-display', {
                    url: videoUrl,
                    responsive: true,
                    // CHANGED: Click to Play for lessons
                    autoplay: false,
                    muted: false,
                    controls: true
                });
            }
        }

        function initVimeo() {
            loadLesson(0);
        }

        function updateLessonText(index) {
            const lesson = lessonData[index];
            document.getElementById('lesson-title').innerText = lesson.title;
            document.getElementById('lesson-desc').innerText = lesson.desc;

            let detailsContainer = document.getElementById('lesson-details-text');
            if(!detailsContainer) {
                const header = document.querySelector('.lesson-header');
                detailsContainer = document.createElement('p');
                detailsContainer.id = 'lesson-details-text';
                detailsContainer.style.marginTop = "20px";
                detailsContainer.style.color = "#ccc";
                detailsContainer.style.lineHeight = "1.6";
                header.appendChild(detailsContainer);
            }
            detailsContainer.innerHTML = lesson.details || "";

            const resourceBox = document.querySelector('.resources-box');
            if (lesson.downloadLink && lesson.downloadLink !== "#") {
                resourceBox.innerHTML = `
                    <h4 style="color:white; margin-bottom:15px;">Downloads</h4>
                    <div class="resource-item">
                        <i class="fas fa-file-download" style="color:var(--primary);"></i>
                        <div style="color:white; margin-left:10px;">${lesson.downloadName}</div>
                        <a href="${lesson.downloadLink}" target="_blank" class="btn btn-secondary" style="margin-left:auto; padding: 5px 15px; font-size: 0.8rem;">Download</a>
                    </div>
                `;
            } else {
                resourceBox.innerHTML = `<h4 style="color:white; margin-bottom:15px;">Downloads</h4><p style="color:#666;">No downloads available for this lesson.</p>`;
            }

            document.querySelectorAll('.lesson-item').forEach((el, i) => {
                if (i === index) el.classList.add('active');
                else el.classList.remove('active');
            });
        }

        // --- AUTH & NAV ---
        async function showSection(sectionId) {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('lms-page').classList.add('hidden');
            
            if(sectionId === 'landing') {
                document.getElementById('landing-page').classList.remove('hidden');
            } else if(sectionId === 'lms') {
                const { data: { session } } = await supabaseClient.auth.getSession();
                if(session) {
                    const { data: profile } = await supabaseClient.from('profiles').select('has_access').eq('id', session.user.id).single();
                    if (profile && profile.has_access) {
                        document.getElementById('lms-page').classList.remove('hidden');
                        initVimeo();
                    } else {
                        alert("Please purchase the course to access.");
                        showSection('landing');
                    }
                } else {
                    alert("Please log in.");
                    showSection('landing');
                    openLoginModal();
                }
            }
        }

        async function attemptLogin() {
            const email = document.getElementById('student-email').value;
            const password = document.getElementById('student-pass').value;
            const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });
            
            if (!error) {
                closeLoginModal();
                updateCourseUI(data.user);
                updateNavButton({ user: data.user });
                if (window.pendingCheckout) {
                    openCheckout();
                    window.pendingCheckout = false;
                }
            } else {
                document.getElementById('login-error').innerText = error.message;
            }
        }

        async function attemptSignUp() {
            const email = document.getElementById('student-email').value;
            const password = document.getElementById('student-pass').value;
            
            if (!email || !password) {
                document.getElementById('login-error').innerText = "Please enter both email and password.";
                return;
            }

            const { data, error } = await supabaseClient.auth.signUp({
                email: email,
                password: password,
            });

            if (!error) {
                alert("Account created! You are now logged in.");
                closeLoginModal();
                updateCourseUI(data.user);
                updateNavButton({ user: data.user });
                if (window.pendingCheckout) {
                    openCheckout();
                    window.pendingCheckout = false;
                }
            } else {
                document.getElementById('login-error').innerText = error.message;
            }
        }

        async function updateCourseUI(user) {
            const priceDisplay = document.getElementById('course-price-display');
            const ctaContainer = document.getElementById('course-cta-container');
            if (user) {
                const { data: profile } = await supabaseClient.from('profiles').select('has_access').eq('id', user.id).single();
                if (profile && profile.has_access) {
                    // Paid
                    if(priceDisplay) priceDisplay.style.display = 'none';
                    if(ctaContainer) ctaContainer.innerHTML = `<button onclick="showSection('lms')" class="btn btn-primary" style="width:100%">ENTER COURSE</button>`;
                } else {
                    // Logged in, not paid
                    if(ctaContainer) ctaContainer.innerHTML = `
                        <button onclick="openTrailer()" class="btn btn-outline-purple" style="width: 100%;">EXPLORE THE COURSE</button>
                        <button onclick="checkLoginAndPay()" class="btn btn-primary" style="width: 100%;">Enroll Now</button>
                    `;
                }
            } else {
                // Guest
                 if(ctaContainer) ctaContainer.innerHTML = `
                    <button onclick="openTrailer()" class="btn btn-outline-purple" style="width: 100%;">EXPLORE THE COURSE</button>
                    <button onclick="checkLoginAndPay()" class="btn btn-primary" style="width: 100%;">Enroll Now</button>
                `;
            }
        }

        function updateNavButton(session) {
            const btn = document.getElementById('nav-login-btn');
            if (session && session.user) {
                btn.innerText = "LOG OUT";
                btn.onclick = async () => { 
                    await supabaseClient.auth.signOut(); 
                    window.location.reload(); 
                };
            } else {
                btn.innerText = "Student Login";
                btn.onclick = openLoginModal;
            }
        }

        // --- MODAL UTILS ---
        function toggleMenu() { document.getElementById('navLinks').classList.toggle('active'); }
        function openLoginModal() { 
            // Reset to Login mode on open
            isSignupMode = true; // Set to true then toggle to false to reset UI correctly
            toggleAuthMode();
            document.getElementById('login-modal').style.display = 'flex'; 
        }
        function closeLoginModal() { document.getElementById('login-modal').style.display = 'none'; }
        
        async function checkLoginAndPay() {
             const { data: { session } } = await supabaseClient.auth.getSession();
             if (session) {
                 openCheckout();
             } else {
                 window.pendingCheckout = true; 
                 openLoginModal();
                 document.getElementById('login-error').innerText = "Please create an account or log in to purchase.";
             }
        }

        function openCheckout() { 
            resetCheckout(); 
            document.getElementById('checkout-modal').style.display = 'flex'; 
        }
        function closeCheckout() { document.getElementById('checkout-modal').style.display = 'none'; }
        
        // --- INIT ---
        supabaseClient.auth.getSession().then(({ data: { session } }) => {
            if(session) {
                updateCourseUI(session.user);
                updateNavButton(session);
            }
        });
        
        // --- PAYPAL ---
        if(document.getElementById('paypal-button-container')) {
             paypal.Buttons({
                createOrder: (data, actions) => actions.order.create({ purchase_units: [{ amount: { value: currentPrice } }] }),
                onApprove: async (data, actions) => {
                    await actions.order.capture();
                    const { data: { user } } = await supabaseClient.auth.getUser();
                    if (user) {
                        await supabaseClient.from('profiles').update({ has_access: true }).eq('id', user.id);
                        alert("Payment successful! Welcome to the Academy."); 
                        closeCheckout(); 
                        updateCourseUI(user);
                        showSection('lms');
                    } else {
                        alert("Please log in before purchasing to save your progress.");
                        closeCheckout();
                        openLoginModal();
                    }
                }
            }).render('#paypal-button-container');
        }
    </script>
</body>
</html>
}